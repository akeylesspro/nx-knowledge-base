{
  "repo": {
    "name": "akeyless-client-commons",
    "source_default_branch": "main"
  },
  "file_name": "emails.ts",
  "source": {
    "file_path": "helpers/emails.ts",
    "commit_sha": "844185137ce1390e1c325518f954aaf0e22f09ff",
    "generated_at_iso": "2026-02-15T11:42:40+02:00",
    "language": "ts",
    "framework_tags": [
      "axios"
    ],
    "link_to_github": "https://github.com/akeyless-client-commons/blob/844185137ce1390e1c325518f954aaf0e22f09ff/src/helpers/emails.ts",
    "link_to_nx_kb": "repos/akeyless-client-commons/docs/helpers/emails.json"
  },
  "summary": {
    "purpose": "Email attachment processing utilities.",
    "problem_solved": "Handles conversion of Blobs and URLs into base64 encoded attachments suitable for sending via email APIs."
  },
  "dependencies": {
    "external": [
      {
        "name": "axios",
        "kind": "runtime",
        "why_used": "Fetches file content from URLs via proxy."
      }
    ],
    "internal": []
  },
  "exports": [
    {
      "name": "EmailAttachment",
      "kind": "interface",
      "description_one_line": "Structure representing an email attachment.",
      "symbol_id": "EmailAttachment"
    },
    {
      "name": "createAttachmentFromBlob",
      "kind": "function",
      "description_one_line": "Converts a Blob to a base64 email attachment object.",
      "symbol_id": "createAttachmentFromBlob"
    },
    {
      "name": "createAttachmentFromUrl",
      "kind": "function",
      "description_one_line": "Downloads a file from a URL and converts it to an attachment.",
      "symbol_id": "createAttachmentFromUrl"
    }
  ],
  "symbols": [
    {
      "symbol_id": "EmailAttachment",
      "name": "EmailAttachment",
      "kind": "interface",
      "description_one_line": "Shape of an email attachment.",
      "details": {
        "what_it_does": "Defines the required fields for an attachment: content (base64), filename, MIME type, and disposition."
      },
      "locations": {
        "source_line_start": 3,
        "source_line_end": 8,
        "github_permalink": "https://github.com/akeyless-client-commons/blob/844185137ce1390e1c325518f954aaf0e22f09ff/src/helpers/emails.ts#L3-L8",
        "nx_kb_anchor": "EmailAttachment"
      },
      "signature": {
        "params": [],
        "returns": {
          "type": "EmailAttachment",
          "description": "The attachment interface object"
        }
      },
      "examples": {
        "minimal_correct": {
          "title": "Creating an attachment object",
          "code": "const attachment: EmailAttachment = {\n  content: 'base64encodeddata...',\n  filename: 'document.pdf',\n  type: 'application/pdf',\n  disposition: 'attachment'\n};"
        },
        "extensive_correct": {
          "title": "Using attachment with email service",
          "code": "const attachment: EmailAttachment = {\n  content: Buffer.from('Hello').toString('base64'),\n  filename: 'hello.txt',\n  type: 'text/plain',\n  disposition: 'inline' // Show in email body\n};\nconst email = {\n  to: 'user@example.com',\n  subject: 'Your attachment',\n  attachments: [attachment]\n};"
        },
        "incorrect_pattern": {
          "title": "Common mistake: Sending raw content instead of base64",
          "code": "// Incorrect - raw content, not base64\nconst attachment = {\n  content: 'raw file content',\n  filename: 'file.pdf'\n};\n// Correct - must be base64 encoded\nconst attachment = {\n  content: Buffer.from('raw content').toString('base64'),\n  filename: 'file.pdf'\n};"
        }
      }
    },
    {
      "symbol_id": "createAttachmentFromBlob",
      "name": "createAttachmentFromBlob",
      "kind": "function",
      "description_one_line": "Blob to Base64 Attachment conversion.",
      "signature": {
        "params": [
          {
            "name": "blob",
            "type": "Blob",
            "required": true,
            "description": "File data."
          },
          {
            "name": "filename",
            "type": "string",
            "required": true,
            "description": "Name for the attachment."
          },
          {
            "name": "mimeType",
            "type": "string",
            "required": false,
            "description": "Override MIME type."
          },
          {
            "name": "disposition",
            "type": "'attachment' | 'inline'",
            "required": false,
            "description": "Default is 'attachment'."
          }
        ],
        "returns": {
          "type": "Promise<EmailAttachment>",
          "description": "The attachment object."
        }
      },
      "details": {
        "what_it_does": "Reads the blob as an ArrayBuffer, converts it to a base64 string (handling both Node.js Buffer and browser btoa), and returns the EmailAttachment object."
      },
      "locations": {
        "source_line_start": 10,
        "source_line_end": 42,
        "github_permalink": "https://github.com/akeyless-client-commons/blob/844185137ce1390e1c325518f954aaf0e22f09ff/src/helpers/emails.ts#L10-L42",
        "nx_kb_anchor": "createAttachmentFromBlob"
      },
      "examples": {
        "minimal_correct": {
          "title": "Converting a file blob to attachment",
          "code": "const blob = new Blob(['Hello'], { type: 'text/plain' });\nconst attachment = await createAttachmentFromBlob(blob, 'hello.txt');\n// Result: { content: 'SGVsbG8=', filename: 'hello.txt', type: 'text/plain', disposition: 'attachment' }"
        },
        "extensive_correct": {
          "title": "Converting PDF blob with custom MIME type",
          "code": "const pdfBlob = await fetch('document.pdf').then(r => r.blob());\nconst attachment = await createAttachmentFromBlob(\n  pdfBlob,\n  'report.pdf',\n  'application/pdf',\n  'attachment'\n);\nawait emailService.send({\n  to: 'recipient@example.com',\n  attachments: [attachment]\n});"
        },
        "incorrect_pattern": {
          "title": "Common mistake: Not awaiting async function",
          "code": "// Incorrect - attachment is a Promise\nconst attachment = createAttachmentFromBlob(blob, 'file.pdf');\nconst email = { attachments: [attachment] }; // Wrong type\n// Correct - await the result\nconst attachment = await createAttachmentFromBlob(blob, 'file.pdf');\nconst email = { attachments: [attachment] }; // Correct"
        }
      }
    },
    {
      "symbol_id": "createAttachmentFromUrl",
      "name": "createAttachmentFromUrl",
      "kind": "function",
      "description_one_line": "URL to Attachment conversion.",
      "signature": {
        "params": [
          {
            "name": "url",
            "type": "string",
            "required": true,
            "description": "File URL."
          },
          {
            "name": "filename",
            "type": "string",
            "required": false,
            "description": "Optional filename."
          }
        ],
        "returns": {
          "type": "Promise<EmailAttachment>",
          "description": "The attachment object."
        }
      },
      "details": {
        "what_it_does": "Fetches the file via a local proxy `/api/proxy-file` to bypass potential CORS issues, then converts the response blob to an attachment."
      },
      "locations": {
        "source_line_start": 55,
        "source_line_end": 62,
        "github_permalink": "https://github.com/akeyless-client-commons/blob/844185137ce1390e1c325518f954aaf0e22f09ff/src/helpers/emails.ts#L55-L62",
        "nx_kb_anchor": "createAttachmentFromUrl"
      },
      "examples": {
        "minimal_correct": {
          "title": "Downloading and converting a file from URL",
          "code": "const attachment = await createAttachmentFromUrl('https://example.com/document.pdf');\n// Automatically extracts 'document.pdf' from URL"
        },
        "extensive_correct": {
          "title": "Downloading file with custom filename",
          "code": "async function sendReportEmail() {\n  const reportUrl = 'https://reports.example.com/2024-annual.pdf';\n  const attachment = await createAttachmentFromUrl(\n    reportUrl,\n    'Annual_Report_2024.pdf' // Custom filename\n  );\n  await emailService.send({\n    to: 'board@example.com',\n    subject: 'Annual Report',\n    attachments: [attachment]\n  });\n}"
        },
        "incorrect_pattern": {
          "title": "Common mistake: Not providing proxy endpoint",
          "code": "// Incorrect - direct fetch may fail due to CORS\nconst blob = await fetch('https://external.com/file.pdf').then(r => r.blob());\n// Correct - uses local proxy to bypass CORS\nconst attachment = await createAttachmentFromUrl('https://external.com/file.pdf');\n// Requires /api/proxy-file endpoint"
        }
      }
    }
  ],
  "quality": {
    "generation_confidence": "high"
  }
}