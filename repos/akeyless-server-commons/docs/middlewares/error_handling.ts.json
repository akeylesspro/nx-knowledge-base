{
  "repo": {
    "name": "akeyless-server-commons",
    "source_default_branch": "main"
  },
  "file_name": "error_handling.ts",
  "source": {
    "file_path": "middlewares/error_handling.ts",
    "commit_sha": "fdd501a3d2595ba30c43f5272500f5ccdefa5308",
    "generated_at_iso": "2026-02-18T08:11:51.000Z",
    "language": "ts",
    "framework_tags": ["node", "express"],
    "link_to_github": "https://github.com/akeyless/akeyless-server-commons/blob/fdd501a3d2595ba30c43f5272500f5ccdefa5308/src/middlewares/error_handling.ts",
    "link_to_nx_kb": "/repos/akeyless-server-commons/docs/middlewares/error_handling.ts"
  },
  "summary": {
    "purpose": "Provides Express error handling utilities: a global error handler middleware and an async error wrapper.",
    "problem_solved": "Eliminates try/catch boilerplate in async route handlers and provides a centralised 500-error response with structured logging."
  },
  "dependencies": {
    "external": [
      {
        "name": "express",
        "kind": "runtime",
        "why_used": "Provides Request, Response, NextFunction types for middleware signatures."
      }
    ],
    "internal": [
      {
        "import_path": "../types",
        "resolved_file_path": "types/index.ts",
        "why_used": "Imports the Service type (async route handler signature).",
        "link_to_nx_kb": "/repos/akeyless-server-commons/docs/types/index.ts",
        "link_to_github": "https://github.com/akeyless/akeyless-server-commons/blob/fdd501a3d2595ba30c43f5272500f5ccdefa5308/src/types/index.ts"
      },
      {
        "import_path": "../managers",
        "resolved_file_path": "managers/index.ts",
        "why_used": "Imports the logger singleton for error logging.",
        "link_to_nx_kb": "/repos/akeyless-server-commons/docs/managers/index.ts",
        "link_to_github": "https://github.com/akeyless/akeyless-server-commons/blob/fdd501a3d2595ba30c43f5272500f5ccdefa5308/src/managers/index.ts"
      }
    ]
  },
  "exports": [
    {
      "name": "error_handler",
      "kind": "function",
      "description_one_line": "Global Express error-handling middleware that logs errors and sends a 500 JSON response.",
      "symbol_id": "error_handler"
    },
    {
      "name": "async_error_handler",
      "kind": "function",
      "description_one_line": "Wraps an async service function to forward unhandled Promise rejections to Express next().",
      "symbol_id": "async_error_handler"
    }
  ],
  "symbols": [
    {
      "symbol_id": "error_handler",
      "name": "error_handler",
      "kind": "function",
      "description_one_line": "Global Express error-handling middleware that logs errors and sends a 500 JSON response.",
      "signature": {
        "params": [
          {"name": "err", "type": "Error", "required": true, "description": "The error passed to next(err)."},
          {"name": "req", "type": "Request", "required": true, "description": "Express request."},
          {"name": "res", "type": "Response", "required": true, "description": "Express response."},
          {"name": "next", "type": "NextFunction", "required": true, "description": "Express next function (required for 4-arg error handler signature)."}
        ],
        "returns": {"type": "void", "description": "Sends a 500 JSON response with { status: 'error', message }."}
      },
      "details": {
        "what_it_does": "Logs the error stack via logger.error, then sends a 500 response with { status: 'error', message: err.message || 'Internal Server Error' }.",
        "side_effects": ["Must be registered as the last middleware in the Express app."]
      },
      "examples": {
        "minimal_correct": {"title": "Register as global error handler", "code": "app.use(error_handler);"}
      },
      "locations": {"source_line_start": 17, "source_line_end": 24, "github_permalink": "https://github.com/akeyless/akeyless-server-commons/blob/fdd501a3d2595ba30c43f5272500f5ccdefa5308/src/middlewares/error_handling.ts#L17", "nx_kb_anchor": "error_handler"}
    },
    {
      "symbol_id": "async_error_handler",
      "name": "async_error_handler",
      "kind": "function",
      "description_one_line": "Wraps an async service function to forward unhandled Promise rejections to Express next().",
      "signature": {
        "params": [{"name": "service", "type": "Service", "required": true, "description": "An async Express route handler function (req, res) => Promise<void>."}],
        "returns": {"type": "(req, res, next) => void", "description": "A standard Express middleware that catches Promise rejections and forwards them to next()."}
      },
      "details": {
        "what_it_does": "Wraps the service call in Promise.resolve().catch(next) so that any thrown errors or rejected promises are forwarded to the global error_handler middleware."
      },
      "examples": {
        "minimal_correct": {"title": "Wrap an async route handler", "code": "app.get('/data', async_error_handler(async (req, res) => {\n  const data = await fetchData();\n  res.json(json_ok(data));\n}));"}
      },
      "locations": {"source_line_start": 8, "source_line_end": 12, "github_permalink": "https://github.com/akeyless/akeyless-server-commons/blob/fdd501a3d2595ba30c43f5272500f5ccdefa5308/src/middlewares/error_handling.ts#L8", "nx_kb_anchor": "async_error_handler"}
    }
  ],
  "quality": {
    "generation_confidence": "high",
    "known_gaps": []
  }
}
